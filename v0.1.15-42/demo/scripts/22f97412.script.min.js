"use strict";var app=angular.module("app",[]);app.controller("Reader_controller",["$scope","$exceptionHandler","Book",function(a,b,c){function d(a){console.log(a),$("#log div").prepend("<p>"+JSON.stringify(a)+"</p>")}var e="https://api.blinkboxbooks.com/service/catalogue/books/";a.$watch("isbn.value",function(f){f&&c.get(e+f).then(function(b){READER.init({container:"#reader_container",width:400,height:400,padding:0,url:b,bookmarks:[],listener:d,preferences:{margin:[9.8,11,6.5,11],textAlign:"left",fontFamily:"Helvetica",theme:"light"}}),a.$watch("lineHeight.value",READER.setLineHeight),a.$watch("fontSize.value",READER.setFontSize),a.$watch("font",function(a){READER.setFontFamily(a)})},function(a){b({message:a.status,stack:a.config},a)})}),a.dimensions=angular.extend({width:"500",height:"600",columns:1,padding:0},a.dimensions),a.$watch("width.value",function(b){b>=0&&(a.dimensions.width=b,READER.resizeContainer(a.dimensions))}),a.$watch("height.value",function(b){b>=0&&(a.dimensions.height=b,READER.resizeContainer(a.dimensions))}),a.lineHeight={min:1.1,max:20,step:.01,value:1.2},a.fontSize={min:.5,max:15,step:.1,value:1},a.fonts=["Helvetica","Times new Roman","Courier New","Arial"],a.font=a.fonts[0],a.alignment=["left","justify"],a.align=a.alignment[0],a.$watch("align",function(a){READER.setTextAlign(a)}),a.setTheme=READER.setTheme,a.setMargin=READER.setMargin,a.getCFI=function(){console.log("Current CFI",decodeURIComponent(READER.getCFI()))},a.next=function(){READER.next()},a.previous=function(){READER.prev()}}]),app.factory("Book",["$http",function(a){return{get:function(b){var c={url:b,method:"GET"};return a(c).then(function(a){if(a.data.links&&a.data.links.length>0){var b,c;for(b=0,c=a.data.links.length;b!==c;b+=1){var d=a.data.links[b];if("Sample"===d.title&&""!==d.href){var e=document.createElement("a");e.href=d.href;var f=0===e.pathname.indexOf("/")?e.pathname:"/"+e.pathname;return"//"+e.hostname+"/params;v=0"+f}}}})}}}]);